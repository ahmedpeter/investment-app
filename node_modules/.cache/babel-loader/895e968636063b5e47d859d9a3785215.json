{"ast":null,"code":"import axios from 'axios';\nimport jwt_decode from 'jwt-decode';\nimport dayjs from 'dayjs';\nconst BASE_URL = 'https://dry-falls-41890.herokuapp.com/api/v1/';\nlet authTokens = localStorage.getItem('authTokens') ? JSON.parse(localStorage.getItem('authTokens')) : null;\nconst axiosInstance = axios.create({\n  BASE_URL,\n  headers: {\n    Authorization: `Bearer ${authTokens === null || authTokens === void 0 ? void 0 : authTokens.accessToken}`\n  }\n});\naxiosInstance.interceptors.request.use(async req => {\n  if (!authTokens) {\n    // authTokens = localStorage.getItem('authTokens') ? JSON.parse(localStorage.getItem('authTokens'))\n    req.headers.Authorization = `Bearer ${authTokens === null || authTokens === void 0 ? void 0 : authTokens.accessToken}`;\n  }\n\n  const user = jwt_decode(authTokens.accessToken);\n  const isExpired = dayjs.unix(user.exp).diff(dayjs()) < 1;\n  if (isExpired) return req;\n  const response = await axios.post(`${BASE_URL}/token`, {\n    refreshToken: authTokens.refreshToken\n  });\n  localStorage.setItem('authTokens', JSON.stringify(response.data));\n  req.headers.Authorization = `Bearer ${authTokens === null || authTokens === void 0 ? void 0 : authTokens.accessToken}`;\n  return req;\n});\nexport default axiosInstance;","map":{"version":3,"sources":["/Users/primalaero/globaltrade/investment-app/src/Util/axiosInstance.js"],"names":["axios","jwt_decode","dayjs","BASE_URL","authTokens","localStorage","getItem","JSON","parse","axiosInstance","create","headers","Authorization","accessToken","interceptors","request","use","req","user","isExpired","unix","exp","diff","response","post","refreshToken","setItem","stringify","data"],"mappings":"AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,OAAOC,UAAP,MAAuB,YAAvB;AACA,OAAOC,KAAP,MAAkB,OAAlB;AAGA,MAAMC,QAAQ,GAAI,+CAAlB;AAGA,IAAIC,UAAU,GAAGC,YAAY,CAACC,OAAb,CAAqB,YAArB,IAAqCC,IAAI,CAACC,KAAL,CAAWH,YAAY,CAACC,OAAb,CAAqB,YAArB,CAAX,CAArC,GAAqF,IAAtG;AAEA,MAAMG,aAAa,GAAGT,KAAK,CAACU,MAAN,CAAa;AAC/BP,EAAAA,QAD+B;AAE/BQ,EAAAA,OAAO,EAAE;AAAEC,IAAAA,aAAa,EAAG,UAASR,UAAV,aAAUA,UAAV,uBAAUA,UAAU,CAAES,WAAY;AAAnD;AAFsB,CAAb,CAAtB;AAMAJ,aAAa,CAACK,YAAd,CAA2BC,OAA3B,CAAmCC,GAAnC,CAAuC,MAAMC,GAAN,IAAa;AAChD,MAAG,CAACb,UAAJ,EAAe;AACX;AACAa,IAAAA,GAAG,CAACN,OAAJ,CAAYC,aAAZ,GAA6B,UAASR,UAAV,aAAUA,UAAV,uBAAUA,UAAU,CAAES,WAAY,EAA9D;AACH;;AACD,QAAMK,IAAI,GAAGjB,UAAU,CAACG,UAAU,CAACS,WAAZ,CAAvB;AACA,QAAMM,SAAS,GAAGjB,KAAK,CAACkB,IAAN,CAAWF,IAAI,CAACG,GAAhB,EAAqBC,IAArB,CAA0BpB,KAAK,EAA/B,IAAqC,CAAvD;AACA,MAAGiB,SAAH,EAAc,OAAOF,GAAP;AAEd,QAAMM,QAAQ,GAAG,MAAMvB,KAAK,CAACwB,IAAN,CAAY,GAAErB,QAAS,QAAvB,EAAgC;AACnDsB,IAAAA,YAAY,EAAErB,UAAU,CAACqB;AAD0B,GAAhC,CAAvB;AAIApB,EAAAA,YAAY,CAACqB,OAAb,CAAqB,YAArB,EAAmCnB,IAAI,CAACoB,SAAL,CAAeJ,QAAQ,CAACK,IAAxB,CAAnC;AACAX,EAAAA,GAAG,CAACN,OAAJ,CAAYC,aAAZ,GAA6B,UAASR,UAAV,aAAUA,UAAV,uBAAUA,UAAU,CAAES,WAAY,EAA9D;AAEA,SAAOI,GAAP;AAIH,CApBD;AAuBA,eAAeR,aAAf","sourcesContent":["import axios from 'axios';\nimport jwt_decode from 'jwt-decode';\nimport dayjs from 'dayjs';\n\n\nconst BASE_URL =  'https://dry-falls-41890.herokuapp.com/api/v1/';\n\n\nlet authTokens = localStorage.getItem('authTokens') ? JSON.parse(localStorage.getItem('authTokens')): null;\n\nconst axiosInstance = axios.create({\n    BASE_URL,\n    headers: { Authorization: `Bearer ${authTokens?.accessToken}` }\n});\n\n\naxiosInstance.interceptors.request.use(async req => {\n    if(!authTokens){\n        // authTokens = localStorage.getItem('authTokens') ? JSON.parse(localStorage.getItem('authTokens'))\n        req.headers.Authorization = `Bearer ${authTokens?.accessToken}`\n    }\n    const user = jwt_decode(authTokens.accessToken)\n    const isExpired = dayjs.unix(user.exp).diff(dayjs()) < 1;\n    if(isExpired) return req\n\n    const response = await axios.post(`${BASE_URL}/token`, {\n        refreshToken: authTokens.refreshToken\n    });\n\n    localStorage.setItem('authTokens', JSON.stringify(response.data))\n    req.headers.Authorization = `Bearer ${authTokens?.accessToken}`\n\n    return req;\n\n\n    \n})\n\n\nexport default axiosInstance;"]},"metadata":{},"sourceType":"module"}